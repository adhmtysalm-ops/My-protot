<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Direct Login</title>
    <style>
        body { background: #000; color: #D4AF37; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 0; }
        .container { border: 1px solid #333; padding: 40px; border-radius: 10px; width: 350px; text-align: center; background: #111; }
        input, select, button { width: 100%; padding: 15px; margin: 10px 0; border-radius: 5px; border: 1px solid #444; background: #222; color: #fff; box-sizing: border-box; }
        button { background: #D4AF37; color: #000; font-weight: bold; cursor: pointer; font-size: 16px; }
        button:hover { background: #fff; }
        #dashboard { display: none; } /* ŸÖÿÆŸÅŸä ŸÅŸä ÿßŸÑÿ®ÿØÿßŸäÿ© */
    </style>
</head>
<body>

    <div id="login-box" class="container">
        <h2>üîí Admin Login</h2>
        <input type="email" id="email" placeholder="Email">
        <input type="password" id="password" placeholder="Password">
        <button id="btnLogin">Login Now</button>
    </div>

    <div id="dashboard" class="container">
        <h2>üöÄ Add Project</h2>
        <p>Welcome, Adham!</p>
        
        <input type="text" id="p_title" placeholder="Project Title">
        <select id="p_category">
            <option value="Branding">Branding</option>
            <option value="Packaging">Packaging</option>
            <option value="Art Direction">Art Direction</option>
            <option value="Typography">Typography</option>
            <option value="Web Design">Web Design</button>
            <option value="3D Design">3D Design</button>
        </select>
        
        <label style="font-size: 12px; color: #aaa; display:block; text-align:left;">Image Name (e.g. 10.png)</label>
        <input type="text" id="p_imageName" placeholder="10.png">
        
        <button id="btnAdd">Publish Project</button>
        <button onclick="location.reload()" style="background:#c0392b; color:white; margin-top:20px;">Logout</button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
        import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAKIka5HU3X_g0TLWknUEtOu6ydFsvLU8E",
            authDomain: "adham-ayta.firebaseapp.com",
            projectId: "adham-ayta",
            storageBucket: "adham-ayta.firebasestorage.app",
            messagingSenderId: "584582572316",
            appId: "1:584582572316:web:ff476d21cfaab3c49af2d9"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // 1. ŸÅÿ≠ÿµ ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ≥ÿ¨ŸÑ ÿØÿÆŸàŸÑ ŸÖÿ≥ÿ®ŸÇÿßŸãÿü
        onAuthStateChanged(auth, (user) => {
            if (user && user.email === "ADHAMatyaadmin231@gml.com") {
                // ŸÑŸà ŸÖÿ≥ÿ¨ŸÑÿå ÿßŸÅÿ™ÿ≠ ÿßŸÑÿØÿßÿ¥ÿ®Ÿàÿ±ÿØ ÿπŸÑÿ∑ŸàŸÑ
                document.getElementById('login-box').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
            }
        });

        // 2. ÿ≤ÿ± ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ
        document.getElementById('btnLogin').addEventListener('click', () => {
            const email = document.getElementById('email').value;
            const pass = document.getElementById('password').value;
            const btn = document.getElementById('btnLogin');

            if(!email || !pass) { alert("Please enter Email & Password"); return; }

            btn.innerText = "Checking...";

            signInWithEmailAndPassword(auth, email, pass)
                .then((userCredential) => {
                    // ŸÜÿ¨ÿßÿ≠ ÿßŸÑÿØÿÆŸàŸÑ
                    if(userCredential.user.email === "ADHAMatyaadmin231@gml.com") {
                        document.getElementById('login-box').style.display = 'none';
                        document.getElementById('dashboard').style.display = 'block';
                    } else {
                        alert("Wrong Email! This is not the admin.");
                    }
                })
                .catch((error) => {
                    // ŸÅÿ¥ŸÑ ÿßŸÑÿØÿÆŸàŸÑ
                    console.error(error);
                    btn.innerText = "Login Now";
                    // ÿ•ÿ∏Ÿáÿßÿ± ÿ≥ÿ®ÿ® ÿßŸÑÿÆÿ∑ÿ£ ŸÅŸä ÿ±ÿ≥ÿßŸÑÿ©
                    alert("Error: " + error.message); 
                });
        });

        // 3. ÿ≤ÿ± ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖÿ¥ÿ±Ÿàÿπ
        document.getElementById('btnAdd').addEventListener('click', async () => {
            const title = document.getElementById('p_title').value;
            const category = document.getElementById('p_category').value;
            let imageName = document.getElementById('p_imageName').value.trim();
            const btn = document.getElementById('btnAdd');

            if (!title || !imageName) { alert("Fill all fields"); return; }
            if(imageName.startsWith('/')) imageName = imageName.substring(1);

            btn.innerText = "Uploading...";

            try {
                await addDoc(collection(db, "portfolio_items"), {
                    title: title, category: category, imageUrl: imageName, createdAt: serverTimestamp()
                });
                alert("Success! Project Added.");
                btn.innerText = "Publish Project";
                document.getElementById('p_title').value = '';
                document.getElementById('p_imageName').value = '';
            } catch (error) {
                alert("Failed: " + error.message);
                btn.innerText = "Publish Project";
            }
        });
    </script>
</body>
</html>
